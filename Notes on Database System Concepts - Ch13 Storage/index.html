<!DOCTYPE html>













<html class="theme-next muse" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222"/>


  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"/>



  
  
    
      
    
    
      
    
  <script src="//cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1.0.2/themes/blue/pace-theme-minimal.css"/>





  <meta http-equiv="Cache-Control" content="no-transform"/>
  <meta http-equiv="Cache-Control" content="no-siteapp"/>



  <meta name="google-site-verification" content="true"/>







  <meta name="baidu-site-verification" content="vh3BWN1atu" />



  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/fancybox@3.0.0/dist/css/jquery.fancybox.min.css"/>







  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"/>

<link rel="stylesheet" href="/css/main.css?v=7.0.1"/>



  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.0.1">








<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: true,
    lazyload: true,
    tabs: true,
    motion: {"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeIn","post_body":"fadeIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  



<script type="text/javascript">
  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//st.flyhigher.top/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>

  <meta name="description" content="[TOC] This series of blogs record notes on indexing and queries in Database System Concepts, 7th edition, thus mainly on RDBMS. Ch13 Data Storage StructuresPersistence to disk. Though DB is based on F">
<meta property="og:type" content="article">
<meta property="og:title" content="Notes on Database System Concepts - Ch13">
<meta property="og:url" content="https://www.virgilsun.com/Notes%20on%20Database%20System%20Concepts%20-%20Ch13%20Storage/index.html">
<meta property="og:site_name" content="Sun&#39;s Blog">
<meta property="og:description" content="[TOC] This series of blogs record notes on indexing and queries in Database System Concepts, 7th edition, thus mainly on RDBMS. Ch13 Data Storage StructuresPersistence to disk. Though DB is based on F">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.loli.net/2021/12/06/OZdxSPlW4jUB2Hh.png">
<meta property="og:image" content="https://s2.loli.net/2021/12/06/yFzuXRiK6hsY9xp.png">
<meta property="og:image" content="https://s2.loli.net/2021/12/06/OqGyzwFg2n6bvoR.png">
<meta property="article:published_time" content="2021-12-05T16:00:00.000Z">
<meta property="article:modified_time" content="2021-12-06T13:27:51.679Z">
<meta property="article:author" content="Virgil Sun">
<meta property="article:tag" content="Storage">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2021/12/06/OZdxSPlW4jUB2Hh.png">



  <link rel="alternate" href="/atom.xml" title="Sun's Blog" type="application/atom+xml"/>



  
  
  <link rel="canonical" href="https://www.virgilsun.com/Notes%20on%20Database%20System%20Concepts%20-%20Ch13%20Storage/"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Notes on Database System Concepts - Ch13 | Sun's Blog</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?db5a55d89cc89dd77ff08de18d30e45f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<meta name="generator" content="Hexo 5.4.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Sun's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">Goose had left marks.</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br/>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br/>Tags<span class="badge">23</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br/>Categories<span class="badge">3</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br/>Archives<span class="badge">15</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-13/36">

    
    
    
      
    

    
      
    

    <a href="/sentence" rel="section"><i class="menu-item-icon fa fa-fw fa-align-left"></i> <br/>13/36</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br/>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    
  
  

  

  <a href="https://github.com/SwJay" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.virgilsun.com/Notes%20on%20Database%20System%20Concepts%20-%20Ch13%20Storage/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Virgil Sun"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="https://i.loli.net/2019/04/02/5ca34b140d93c.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sun's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Notes on Database System Concepts - Ch13

              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2021-12-06 00:00:00 / Modified: 21:27:51" itemprop="dateCreated datePublished" datetime="2021-12-06T00:00:00+08:00">2021-12-06</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Database/" itemprop="url" rel="index"><span itemprop="name">Database</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/Notes%20on%20Database%20System%20Concepts%20-%20Ch13%20Storage/" class="leancloud_visitors" data-flag-title="Notes on Database System Concepts - Ch13">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                
                  
                    
                  
                
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>[TOC]</p>
<p>This series of blogs record notes on indexing and queries in Database System Concepts, 7th edition, thus mainly on RDBMS.</p>
<h1 id="Ch13-Data-Storage-Structures"><a href="#Ch13-Data-Storage-Structures" class="headerlink" title="Ch13 Data Storage Structures"></a>Ch13 Data Storage Structures</h1><p>Persistence to disk. Though DB is based on FS, it still needs to be aware of blocks (pages) from underlying storage to support recovery from failure.</p>
<h2 id="13-2-File-Organization"><a href="#13-2-File-Organization" class="headerlink" title="13.2 File Organization"></a>13.2 File Organization</h2><p>File: logically sequence as series of records, partitioned into fixed-length storage units called <strong>blocks</strong>.</p>
<h3 id="13-2-1-Fixed-Length-Records"><a href="#13-2-1-Fixed-Length-Records" class="headerlink" title="13.2.1 Fixed-Length Records"></a>13.2.1 Fixed-Length Records</h3><p>A table with fixed row size.</p>
<ul>
<li><p>Two issues:</p>
<ol>
<li>cross-block records: so long as the block size is not a multiple of row size, part of the record will be stored in former block while the rest part in the latter.</li>
<li>How to delete: space occupied by a deleted record should be filled with another record.</li>
</ol>
</li>
<li><p>Solutions:</p>
<ol>
<li><p>Keep remaining space (less than row size) empty</p>
</li>
<li><p>Use <strong>free list</strong> to record deleted records: File header records the address of the first deleted records,  one deleted record points to the next one, thus forming a list.</p>
<p><img src="https://s2.loli.net/2021/12/06/OZdxSPlW4jUB2Hh.png" alt="free_list"></p>
</li>
</ol>
</li>
</ul>
<h3 id="13-2-2-Variable-Length-Records"><a href="#13-2-2-Variable-Length-Records" class="headerlink" title="13.2.2 Variable-Length Records"></a>13.2.2 Variable-Length Records</h3><ol>
<li><p>How to represent a single record with variable-length: initial fixed-length part (content + meta) + variable-length attribute content</p>
<p><img src="https://s2.loli.net/2021/12/06/yFzuXRiK6hsY9xp.png" alt="record_representation"></p>
<ul>
<li>initial fixed-length part<ul>
<li><offset, length> pair: indicating position and size for variable-length attribute</li>
<li>fixed-length attribute value</li>
<li><strong>null bitmap</strong>: indicating null value</li>
</ul>
</li>
<li>variable-length content</li>
</ul>
</li>
<li><p>How to store variable-length records in a block: <strong>slotted-page structure</strong></p>
<p><img src="https://s2.loli.net/2021/12/06/OqGyzwFg2n6bvoR.png" alt="image.png"></p>
<ul>
<li><p>block header</p>
<ul>
<li># records</li>
<li>pointer: end of free space</li>
<li>array whose entris contain <location, size> of each record</li>
</ul>
</li>
<li><p>free space: between header and records</p>
</li>
<li><p>actual records:</p>
<ul>
<li>allocated contiguously in the block, starting from the end of the block.</li>
<li>insertion: allocate space in free space</li>
<li>deletion (same for recod growing/shrinking): mark entry, move frontier transactions to cover deleted space.</li>
<li>pointers can’t point to records, but to entries.</li>
</ul>
</li>
<li><p>:question:</p>
<ul>
<li>For deletion, the space of the deleted record is occupied by moving frontier transactions, but its entry is just marked as delete. Is this because, entry is fixed-length, s.t. it can be reused for later insertion so we don’t delete it, but record is variable-length so we delete it and move other records to cover it?</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="13-3-Organization-of-Records-in-Files"><a href="#13-3-Organization-of-Records-in-Files" class="headerlink" title="13.3 Organization of Records in Files"></a>13.3 Organization of Records in Files</h2><ul>
<li>Heap: no order</li>
<li>Sequential: stored in sequential order according the value of a search key</li>
<li>Multitable clustering: records from different relation/table are stored in the same block, to reduce the cost of certain join operations.</li>
<li>B+-tree: provide ordered access, and efficient point query (Ch 14.4.1).</li>
<li>Hashing (Ch 14.5).</li>
</ul>
<h3 id="13-3-1-Heap-File-Organization"><a href="#13-3-1-Heap-File-Organization" class="headerlink" title="13.3.1 Heap File Organization"></a>13.3.1 Heap File Organization</h3><p>Stored in an unordered manner, free up the space of deleted records to store future inserted records. Most databases use a space-efficient data structure called a <strong>free-space map</strong> to track which blocks have free space to store records.</p>
<p>It’s commonly represented by an array containing 1 entry for each block, and the entry represents the occupancy fraction $f$ that at least a fraction $f$ of the space in the block is free. PostgreSQL, for example, an entry is 1 byte, thus storing number $x=0$ to $255$,  representing occupancy fraction $f=\frac{x}{256}$.</p>
<p>Can build second-level free-space map where each second-level entry stores the maximum value among multiple blocks.</p>
<h3 id="13-3-2-Sequential-File-Organization"><a href="#13-3-2-Sequential-File-Organization" class="headerlink" title="13.3.2 Sequential File Organization"></a>13.3.2 Sequential File Organization</h3><p>It’s designed for efficient processing of records in sorted order based on some <strong>search key</strong>. Each records are chained by pointers pointing to the next record in search-key order. To minimize # block accesses in sequential file processing, we store records <em>physically</em> close to the search key order.</p>
<ul>
<li>deletion: use pointer chains</li>
<li>insertion: apply following 2 rules<ol>
<li>Locate the record in the ﬁle that comes before the record to be inserted in search-key order.</li>
<li>If there is free space within the same block, insert there; otherwise, insert in an <em>overflow block</em>. In either case, adjust pointers to chain together in search-key order.</li>
</ol>
</li>
</ul>
<p>Need to be reorganized from time to time, s.t. physical order matches search-key order.</p>
<h2 id="13-5-Database-Buffer"><a href="#13-5-Database-Buffer" class="headerlink" title="13.5 Database Buffer"></a>13.5 Database Buffer</h2><p>Since database data reside primarily on disk and disk access is much slower, a major goal of DB is to minimize # block transfers between the disk and memory. To do so, one way is to keep as many blocks as possible in memory. The goal is to maximize the chance that when accessing a block, it’s already in memory.</p>
<p><strong>Buffer</strong>: part of main memory available for storage of copies of disk blocks. The subsystem responsible for the allocation of buﬀer space is called the <strong>buﬀer manager</strong>.</p>
<h3 id="13-5-1-Buffer-Manager"><a href="#13-5-1-Buffer-Manager" class="headerlink" title="13.5.1 Buffer Manager"></a>13.5.1 Buffer Manager</h3><h4 id="13-5-1-1-Buffer-replacement-strategy"><a href="#13-5-1-1-Buffer-replacement-strategy" class="headerlink" title="13.5.1.1 Buffer replacement strategy"></a>13.5.1.1 Buffer replacement strategy</h4><p>When a new block comes in and there is no room in memory, an old block must be <strong>evicted</strong>. Most OS use LRU scheme, and it can be improved on for DB applications (Ch13.5.2)</p>
<h4 id="13-5-1-2-Pinned-blocks"><a href="#13-5-1-2-Pinned-blocks" class="headerlink" title="13.5.1.2 Pinned blocks"></a>13.5.1.2 Pinned blocks</h4><p>It’s similar to concurreny control. A block should not be evicted when the DB process is reading/writing it. To do so, <strong>pin</strong> a block s.t. it can’t be evicted by buffer manager, and <strong>unpin</strong> it when finsh operation. For multiprocess, use <strong>pin count</strong> fir each buffer block, s.t. it can’r be evicted by buffer manager unless count equals to 0.</p>
<h4 id="13-5-1-3-Shared-and-Exclusive-Locks-on-Buffer"><a href="#13-5-1-3-Shared-and-Exclusive-Locks-on-Buffer" class="headerlink" title="13.5.1.3 Shared and Exclusive Locks on Buffer"></a>13.5.1.3 Shared and Exclusive Locks on Buffer</h4><p>Shared block (read only) &amp; exclusive lock (write), detailed locking in Ch 18.</p>
<p>Work flow: pin, get lock, operate, release lock, unpin.</p>
<h3 id="13-5-2-Buffer-Replacement-Strategies"><a href="#13-5-2-Buffer-Replacement-Strategies" class="headerlink" title="13.5.2 Buffer-Replacement Strategies"></a>13.5.2 Buffer-Replacement Strategies</h3><p>LRU: based on a general assumption that a recently referenced block tends to be referenced again. It’s acceptable for OS not DB, since DB can predict the patter nof future references more accurately by looking the several steps compromised the user request.</p>
<p>E.g. MRU for join operation. E.g. prefer to remove record block instead of index blocks since latter are more frequently accessed. No single strategy is known that handles all the possible scenarios well.</p>
<h2 id="13-6-Column-Oriented-Storage"><a href="#13-6-Column-Oriented-Storage" class="headerlink" title="13.6 Column-Oriented Storage"></a>13.6 Column-Oriented Storage</h2><p>Each attribute is stored in a separate file. Each file is compressed.</p>
<p>Thus, it is not suitable for queries that fetch multiple attributes from a few rows of a relation. However, column-oriented storage is well suited for data analysis queries, which process many rows of a relation, but often only access some of the attributes. Reasons are listed below:</p>
<ul>
<li>Reduced I/O. In contrast, in row-oriented storage, irrelevant attributes are fetched from disk.</li>
<li>Improved CPU cache performance. Similar to reduced I/O reduce cost from disk to memory, cost from memory to CPU cache is also reduced by avoiding loading irrelevant attributes.</li>
<li>Improved compression. Effectiveness of compression is significantly increased when storing values of the same type together, compared to different types in row-oriented storage. :question: Details on compression.</li>
<li>Vector processing. Modern CPU supports <strong>vector processing</strong>, i.e. a CPU operation can be applied in parallel on a number of elements of an array. Column-oriented storage allows vector processing like comparing an attribute with a constant, which is important in selection condition. It also enables aggregating multiple values in parallel.</li>
</ul>
<p>Indexing and query processing should be carefully designed to benefit from column-oriented storage (Ch 14.9).</p>
<p>Drawbacks, unsuitable for transaction processing:</p>
<ul>
<li>Cost of tuple reconstruction.</li>
<li>Cost of tuple deletion and update.</li>
<li>Cost of decompression.</li>
</ul>
<p>E.g. <strong>Apache ORC</strong> (Optimized Row Columnar) are columnar file representation.</p>
<h2 id="13-7-Storage-Organization-in-Main-Memory-Databases"><a href="#13-7-Storage-Organization-in-Main-Memory-Databases" class="headerlink" title="13.7 Storage Organization in Main-Memory Databases"></a>13.7 Storage Organization in Main-Memory Databases</h2><p>A <strong>main-memory database</strong> is a database where all data reside in memory.</p>
<p>With disk-based DB, a record pointer consist of a block identifier and offset within the block. First need to check if block is in buffer (usually done by in-memory hash index), if it is, find location; if not fetch from disk. Time consuming. In contrast, main-memory DB can directly point to memory.</p>

      
    </div>

    

    
    
    

    

    
      
    
    
      <div>
        <div id="reward-container">
  <div>If it helps, you may buy me a cup of coffee plz.</div>
  <button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">

    
      
      
        
      
      <div style="display: inline-block">
        <img src="/images/wechatpay.jpg" alt="Virgil Sun WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    
      
      
        
      
      <div style="display: inline-block">
        <img src="/images/alipay.jpg" alt="Virgil Sun Alipay"/>
        <p>Alipay</p>
      </div>
    

  </div>
</div>

      </div>
    

    
      <div>
        




  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Virgil</li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    
    <a href="https://www.virgilsun.com/Notes%20on%20Database%20System%20Concepts%20-%20Ch13%20Storage/" title="Notes on Database System Concepts - Ch13">https://www.virgilsun.com/Notes%20on%20Database%20System%20Concepts%20-%20Ch13%20Storage/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Storage/" rel="tag"># Storage</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div class="social_share">
            
            
              <div id="needsharebutton-postbottom">
                <span class="btn">
                  <i class="fa fa-share-alt" aria-hidden="true"></i>
                </span>
              </div>
            
            
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Notes%20on%20Database%20System%20Concepts%20-%20Ch14%20Indexing/" rel="next" title="Notes on Database System Concepts - Ch14 Indexing">
                <i class="fa fa-chevron-left"></i> Notes on Database System Concepts - Ch14 Indexing
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Notes%20on%20Database%20System%20Concepts%20-%20Ch24%20Advanced%20Indexing/" rel="prev" title="Notes on Database System Concepts - Ch24 Advanced Indexing">
                Notes on Database System Concepts - Ch24 Advanced Indexing <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
        <div id="lv-container" data-id="city" data-uid="MTAyMC80MzU0NS8yMDA4NA=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://i.loli.net/2019/04/02/5ca34b140d93c.jpg"
                alt="Virgil Sun"/>
            
              <p class="site-author-name" itemprop="name">Virgil Sun</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/%20%7C%7C%20archive">
                
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">categories</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">23</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                </span>
                  
                    
                  
                  <a href="https://github.com/SwJay" title="GitHub &rarr; https://github.com/SwJay" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                </span><br/>
                  
                    
                  
                  <a href="mailto:virgilsun@outlook.com" title="Mail &rarr; mailto:virgilsun@outlook.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                </span>
                  
                    
                  
                  <a href="https://www.weibo.com/u/1960293815" title="微博 &rarr; https://www.weibo.com/u/1960293815" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>微博</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                </span>
                  
                    
                  
                  <a href="/atom.xml" title="RSS &rarr; /atom.xml"><i class="fa fa-fw fa-fas fa-rss"></i>RSS</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.drg1998.cn/" title="https://blog.drg1998.cn/" rel="noopener" target="_blank">Guo Shuai</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Ch13-Data-Storage-Structures"><span class="nav-number">1.</span> <span class="nav-text">Ch13 Data Storage Structures</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#13-2-File-Organization"><span class="nav-number">1.1.</span> <span class="nav-text">13.2 File Organization</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-1-Fixed-Length-Records"><span class="nav-number">1.1.1.</span> <span class="nav-text">13.2.1 Fixed-Length Records</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-2-Variable-Length-Records"><span class="nav-number">1.1.2.</span> <span class="nav-text">13.2.2 Variable-Length Records</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-3-Organization-of-Records-in-Files"><span class="nav-number">1.2.</span> <span class="nav-text">13.3 Organization of Records in Files</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-3-1-Heap-File-Organization"><span class="nav-number">1.2.1.</span> <span class="nav-text">13.3.1 Heap File Organization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-3-2-Sequential-File-Organization"><span class="nav-number">1.2.2.</span> <span class="nav-text">13.3.2 Sequential File Organization</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-5-Database-Buffer"><span class="nav-number">1.3.</span> <span class="nav-text">13.5 Database Buffer</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-5-1-Buffer-Manager"><span class="nav-number">1.3.1.</span> <span class="nav-text">13.5.1 Buffer Manager</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#13-5-1-1-Buffer-replacement-strategy"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">13.5.1.1 Buffer replacement strategy</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#13-5-1-2-Pinned-blocks"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">13.5.1.2 Pinned blocks</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#13-5-1-3-Shared-and-Exclusive-Locks-on-Buffer"><span class="nav-number">1.3.1.3.</span> <span class="nav-text">13.5.1.3 Shared and Exclusive Locks on Buffer</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-5-2-Buffer-Replacement-Strategies"><span class="nav-number">1.3.2.</span> <span class="nav-text">13.5.2 Buffer-Replacement Strategies</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-6-Column-Oriented-Storage"><span class="nav-number">1.4.</span> <span class="nav-text">13.6 Column-Oriented Storage</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-7-Storage-Organization-in-Main-Memory-Databases"><span class="nav-number">1.5.</span> <span class="nav-text">13.7 Storage Organization in Main-Memory Databases</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Virgil Sun</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v5.4.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.0.1</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      已有
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次到访 w
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





  



  






  















  
  <script src="//cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/jquery_lazyload@1.9.3/jquery.lazyload.min.js"></script>

  
  <script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.2.1/velocity.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1.2.1/velocity.ui.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/fancybox@3.0.0/dist/js/jquery.fancybox.pack.js"></script>


  


  <script src="/js/utils.js?v=7.0.1"></script>

  <script src="/js/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.0.1"></script>



  
  <script src="/js/scrollspy.js?v=7.0.1"></script>
<script src="/js/post-details.js?v=7.0.1"></script>



  


  <script src="/js/next-boot.js?v=7.0.1"></script>


  

  

  

  


  
    <script>
  window.livereOptions = {
    refer: 'Notes on Database System Concepts - Ch13 Storage/'
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>

  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  
    
  
  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });
  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') { next = next.nextSibling }
        if (next && next.nodeName.toLowerCase() === 'br') { next.parentNode.removeChild(next) }
      }
    });
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      document.getElementById(all[i].inputID + '-Frame').parentNode.className += ' has-jax';
    }
  });
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

    
  


  

  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  
  
  
    
  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script>
  <script>
    
      pbOptions = {};
      
        pbOptions.iconStyle = "box";
      
        pbOptions.boxForm = "horizontal";
      
        pbOptions.position = "bottomCenter";
      
        pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>


  

  

  

  

  

  


  
</body>
</html>
